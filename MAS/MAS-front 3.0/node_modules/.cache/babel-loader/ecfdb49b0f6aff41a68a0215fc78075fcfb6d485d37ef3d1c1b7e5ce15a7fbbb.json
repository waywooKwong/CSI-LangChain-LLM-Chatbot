{"ast":null,"code":"import { dia, shapes } from '@joint/core';\nimport { createApp, h } from 'vue';\nimport AgentNode from '@/components/AgentNode.vue';\nexport default {\n  name: 'AgentMap',\n  data: function data() {\n    return {\n      graph: null,\n      paper: null,\n      agentCounter: 0\n    };\n  },\n  mounted: function mounted() {\n    var _this = this;\n    this.graph = new dia.Graph();\n    this.paper = new dia.Paper({\n      el: document.getElementById('paper'),\n      model: this.graph,\n      width: 1000,\n      height: 800,\n      gridSize: 10,\n      drawGrid: true\n    });\n    this.paper.on('element:pointerdblclick', function (elementView) {\n      _this.graph.getCell(elementView.model).remove();\n    });\n  },\n  methods: {\n    addAgentNode: function addAgentNode() {\n      var _this2 = this;\n      var agentNode = new shapes.standard.Rectangle();\n      agentNode.position(100, 100);\n      agentNode.resize(200, 100);\n      agentNode.attr({\n        body: {\n          fill: 'white',\n          stroke: 'black'\n        }\n      });\n      this.graph.addCell(agentNode);\n      var foreignObject = new dia.Element({\n        position: {\n          x: 100,\n          y: 100\n        },\n        size: {\n          width: 200,\n          height: 100\n        },\n        attrs: {\n          fo: {\n            tagName: 'foreignObject',\n            width: '100%',\n            height: '100%',\n            x: 0,\n            y: 0,\n            stroke: 'none',\n            fill: 'none',\n            html: \"\\n                <div xmlns=\\\"http://www.w3.org/1999/xhtml\\\" style=\\\"width:100%;height:100%;\\\">\\n                  <div id=\\\"vue-container-\".concat(agentNode.id, \"\\\" class=\\\"agent-node-container\\\"></div>\\n                </div>\\n              \")\n          }\n        }\n      });\n      this.graph.addCell(foreignObject);\n      var html = document.getElementById(\"vue-container-\".concat(agentNode.id));\n      createApp({\n        render: function render() {\n          return h(AgentNode, {\n            nodeId: agentNode.id,\n            graph: _this2.graph\n          });\n        }\n      }).mount(html);\n    }\n  }\n};","map":{"version":3,"names":["dia","shapes","createApp","h","AgentNode","name","data","graph","paper","agentCounter","mounted","_this","Graph","Paper","el","document","getElementById","model","width","height","gridSize","drawGrid","on","elementView","getCell","remove","methods","addAgentNode","_this2","agentNode","standard","Rectangle","position","resize","attr","body","fill","stroke","addCell","foreignObject","Element","x","y","size","attrs","fo","tagName","html","concat","id","render","nodeId","mount"],"sources":["src/views/AgentMap.vue"],"sourcesContent":["<template>\n    <div class=\"agent-map\">\n      <div class=\"sidebar\">\n        <button @click=\"addAgentNode\">添加智能体</button>\n      </div>\n      <div id=\"paper\"></div>\n    </div>\n  </template>\n  \n  <script>\n  import { dia, shapes } from '@joint/core';\n  import { createApp, h } from 'vue';\n  import AgentNode from '@/components/AgentNode.vue';\n  \n  export default {\n    name: 'AgentMap',\n    data() {\n      return {\n        graph: null,\n        paper: null,\n        agentCounter: 0,\n      };\n    },\n    mounted() {\n      this.graph = new dia.Graph();\n  \n      this.paper = new dia.Paper({\n        el: document.getElementById('paper'),\n        model: this.graph,\n        width: 1000,\n        height: 800,\n        gridSize: 10,\n        drawGrid: true,\n      });\n  \n      this.paper.on('element:pointerdblclick', (elementView) => {\n        this.graph.getCell(elementView.model).remove();\n      });\n    },\n    methods: {\n      addAgentNode() {\n        const agentNode = new shapes.standard.Rectangle();\n        agentNode.position(100, 100);\n        agentNode.resize(200, 100);\n        agentNode.attr({\n          body: {\n            fill: 'white',\n            stroke: 'black',\n          },\n        });\n  \n        this.graph.addCell(agentNode);\n  \n        const foreignObject = new dia.Element({\n          position: { x: 100, y: 100 },\n          size: { width: 200, height: 100 },\n          attrs: {\n            fo: {\n              tagName: 'foreignObject',\n              width: '100%',\n              height: '100%',\n              x: 0,\n              y: 0,\n              stroke: 'none',\n              fill: 'none',\n              html: `\n                <div xmlns=\"http://www.w3.org/1999/xhtml\" style=\"width:100%;height:100%;\">\n                  <div id=\"vue-container-${agentNode.id}\" class=\"agent-node-container\"></div>\n                </div>\n              `,\n            },\n          },\n        });\n  \n        this.graph.addCell(foreignObject);\n  \n        const html = document.getElementById(`vue-container-${agentNode.id}`);\n  \n        createApp({\n          render: () =>\n            h(AgentNode, {\n              nodeId: agentNode.id,\n              graph: this.graph,\n            }),\n        }).mount(html);\n      },\n    },\n  };\n  </script>\n  \n  <style scoped>\n  .agent-map {\n    display: flex;\n  }\n  \n  .sidebar {\n    width: 200px;\n    padding: 10px;\n    background: #f1f1f1;\n    border-left: 1px solid #ddd;\n  }\n  \n  #paper {\n    flex: 1;\n    position: relative;\n  }\n  \n  .agent-node-container {\n    width: 100%;\n    height: 100%;\n  }\n  </style>\n  "],"mappings":"AAUA,SAAAA,GAAA,EAAAC,MAAA;AACA,SAAAC,SAAA,EAAAC,CAAA;AACA,OAAAC,SAAA;AAEA;EACAC,IAAA;EACAC,IAAA,WAAAA,KAAA;IACA;MACAC,KAAA;MACAC,KAAA;MACAC,YAAA;IACA;EACA;EACAC,OAAA,WAAAA,QAAA;IAAA,IAAAC,KAAA;IACA,KAAAJ,KAAA,OAAAP,GAAA,CAAAY,KAAA;IAEA,KAAAJ,KAAA,OAAAR,GAAA,CAAAa,KAAA;MACAC,EAAA,EAAAC,QAAA,CAAAC,cAAA;MACAC,KAAA,OAAAV,KAAA;MACAW,KAAA;MACAC,MAAA;MACAC,QAAA;MACAC,QAAA;IACA;IAEA,KAAAb,KAAA,CAAAc,EAAA,sCAAAC,WAAA;MACAZ,KAAA,CAAAJ,KAAA,CAAAiB,OAAA,CAAAD,WAAA,CAAAN,KAAA,EAAAQ,MAAA;IACA;EACA;EACAC,OAAA;IACAC,YAAA,WAAAA,aAAA;MAAA,IAAAC,MAAA;MACA,IAAAC,SAAA,OAAA5B,MAAA,CAAA6B,QAAA,CAAAC,SAAA;MACAF,SAAA,CAAAG,QAAA;MACAH,SAAA,CAAAI,MAAA;MACAJ,SAAA,CAAAK,IAAA;QACAC,IAAA;UACAC,IAAA;UACAC,MAAA;QACA;MACA;MAEA,KAAA9B,KAAA,CAAA+B,OAAA,CAAAT,SAAA;MAEA,IAAAU,aAAA,OAAAvC,GAAA,CAAAwC,OAAA;QACAR,QAAA;UAAAS,CAAA;UAAAC,CAAA;QAAA;QACAC,IAAA;UAAAzB,KAAA;UAAAC,MAAA;QAAA;QACAyB,KAAA;UACAC,EAAA;YACAC,OAAA;YACA5B,KAAA;YACAC,MAAA;YACAsB,CAAA;YACAC,CAAA;YACAL,MAAA;YACAD,IAAA;YACAW,IAAA,iJAAAC,MAAA,CAEAnB,SAAA,CAAAoB,EAAA;UAGA;QACA;MACA;MAEA,KAAA1C,KAAA,CAAA+B,OAAA,CAAAC,aAAA;MAEA,IAAAQ,IAAA,GAAAhC,QAAA,CAAAC,cAAA,kBAAAgC,MAAA,CAAAnB,SAAA,CAAAoB,EAAA;MAEA/C,SAAA;QACAgD,MAAA,WAAAA,OAAA;UAAA,OACA/C,CAAA,CAAAC,SAAA;YACA+C,MAAA,EAAAtB,SAAA,CAAAoB,EAAA;YACA1C,KAAA,EAAAqB,MAAA,CAAArB;UACA;QAAA;MACA,GAAA6C,KAAA,CAAAL,IAAA;IACA;EACA;AACA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}